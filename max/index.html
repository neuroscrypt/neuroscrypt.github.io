<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <title>Демо Робота Макса</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      :root {
        --robot-size: 96px;
        --robot-panel-width: 360px;
        --robot-radius: 24px;
        --robot-bg: #ffffff;
        --robot-shadow: 0 12px 30px rgba(0, 0, 0, 0.18);
        --robot-blue: #005ff9;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: #f5f6fa;
        min-height: 100vh;
      }

      /* Корень виджета */
      .robot-max-root {
        position: fixed;
        right: 24px;
        bottom: 24px;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 12px;
        pointer-events: none; /* сам корень не ловит клики */
      }

      /* Плавающая панель чата/инфо */
      .robot-max-panel {
        width: var(--robot-panel-width);
        max-width: calc(100vw - 48px);
        background: var(--robot-bg);
        border-radius: 28px;
        box-shadow: var(--robot-shadow);
        overflow: hidden;
        transform-origin: 100% 100%;
        transform: translateY(12px) scale(0.9);
        opacity: 0;
        pointer-events: none;
        transition:
          opacity 0.28s ease,
          transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
      }

      .robot-max-panel--opened {
        opacity: 1;
        transform: translateY(0) scale(1);
        pointer-events: auto;
      }

      .robot-max-panel__header {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px 16px 10px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      }

      .robot-max-panel__avatar {
        width: 32px;
        height: 32px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 20%, #ffffff, #cde0ff);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .robot-max-panel__avatar-inner {
        width: 24px;
        height: 24px;
        border-radius: 999px;
        background: linear-gradient(135deg, #005ff9, #00bfff);
      }

      .robot-max-panel__title {
        font-size: 14px;
        font-weight: 600;
      }

      .robot-max-panel__subtitle {
        font-size: 12px;
        color: #747b8c;
      }

      .robot-max-panel__body {
        padding: 12px 16px 16px;
        font-size: 13px;
        line-height: 1.5;
        color: #333;
      }

      .robot-max-panel__bubble {
        display: inline-block;
        background: #f0f4ff;
        border-radius: 16px;
        padding: 10px 12px;
      }

      .robot-max-panel__footer {
        padding: 10px 16px 14px;
        border-top: 1px solid rgba(0, 0, 0, 0.05);
        display: flex;
        justify-content: flex-end;
        gap: 8px;
      }

      .robot-max-panel__button {
        border-radius: 999px;
        border: none;
        padding: 6px 12px;
        font-size: 13px;
        cursor: pointer;
        background: #eef2ff;
        color: #333;
      }

      .robot-max-panel__button--primary {
        background: var(--robot-blue);
        color: #fff;
      }

      /* Кнопка-капсула с роботом */
      .robot-max-toggle {
        pointer-events: auto; /* сама кнопка кликабельна */
        border: none;
        padding: 0;
        background: transparent;
        position: relative;
        width: var(--robot-size);
        height: var(--robot-size);
        border-radius: 999px;
        box-shadow: var(--robot-shadow);
        cursor: pointer;
        overflow: hidden;
        background: radial-gradient(circle at 30% 15%, #ffffff, #d9e4ff);
        display: flex;
        align-items: center;
        justify-content: center;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }

      .robot-max-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 16px 32px rgba(0, 0, 0, 0.24);
      }

      .robot-max-toggle:active {
        transform: translateY(0);
        box-shadow: var(--robot-shadow);
      }

      .robot-max-toggle__badge {
        position: absolute;
        top: 4px;
        right: 4px;
        min-width: 18px;
        height: 18px;
        padding: 0 5px;
        border-radius: 999px;
        background: #ff3b30;
        color: #fff;
        font-size: 11px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Контейнер для анимации */
      .robot-max-animation-container {
        width: 72px;
        height: 72px;
        border-radius: 999px;
        overflow: hidden;
        position: relative;
      }

      /* Lottie сам создаст <canvas> внутри этого div */
      .robot-max-animation-inner {
        width: 100%;
        height: 100%;
      }

      /* Скелетон, пока анимация не загрузилась */
      .robot-max-skeleton {
        position: absolute;
        inset: 0;
        border-radius: inherit;
        background: linear-gradient(
          120deg,
          #edf1ff 0%,
          #ffffff 40%,
          #edf1ff 80%
        );
        background-size: 200% 200%;
        animation: robot-max-skeleton 1.4s ease-in-out infinite;
      }

      @keyframes robot-max-skeleton {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      /* Анимация появления робота (самой кнопки) */
      .robot-max-root--mounted .robot-max-toggle {
        animation: robot-max-pop 0.35s
          cubic-bezier(0.2, 1.2, 0.3, 1) 0.12s both;
      }

      @keyframes robot-max-pop {
        0% {
          transform: translateY(40px) scale(0.7);
          opacity: 0;
        }
        100% {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
      }
    </style>

    <!-- Lottie через CDN: глобальная переменная window.lottie -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  </head>

  <body>
    <div id="robot-max-root"></div>

    <!-- Скомпилированный TypeScript (main.js) -->
    <script type="module" src="main.js"></script>
  </body>
</html>